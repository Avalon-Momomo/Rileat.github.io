<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>å¤©æ°” Â· Apple é£</title>

<style>
/* ===== Apple é£æ ¼å˜é‡ ===== */
:root {
  --text: #ffffff;
  --subtext: rgba(255,255,255,0.75);
  --glass: rgba(255,255,255,0.08);
  --blur: blur(22px);
  --radius: 32px;
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", Arial;
}

html, body {
  margin:0; padding:0; height:100%; overflow:hidden;
  background:#000;
}

/* èƒŒæ™¯è§†é¢‘/å›¾å±‚ï¼ˆå¤©æ°”åŠ¨æ€ï¼‰ */
#bg {
  position:fixed; inset:0;
  width:100%; height:100%;
  object-fit:cover;
  z-index:0;
  filter:brightness(0.86);
  transition:opacity 1s ease;
}

/* å…¨å±æ¯›ç»ç’ƒå å±‚ */
.overlay {
  position:fixed; inset:0; 
  backdrop-filter: var(--blur);
  -webkit-backdrop-filter: var(--blur);
  background:rgba(0,0,0,0.15);
  z-index:1;
}

/* ä¸»å†…å®¹åŒºåŸŸ */
.container {
  position:relative;
  z-index:2;
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  padding:48px 32px;
  box-sizing:border-box;
}

/* åŸå¸‚ */
.city {
  font-size:34px;
  font-weight:600;
  color:var(--text);
}

/* æ—¶é—´ */
.time {
  font-size:15px;
  color:var(--subtext);
  margin-top:2px;
}

/* æ¸©åº¦ */
.temp {
  margin-top:40px;
  font-size:96px;
  line-height:1;
  font-weight:600;
  color:var(--text);
}

/* çŠ¶æ€æè¿° */
.cond {
  font-size:22px;
  margin-top:8px;
  color:var(--subtext);
}

/* å¡ç‰‡ */
.card {
  margin-top:auto;
  padding:20px 24px;
  background:var(--glass);
  border-radius:var(--radius);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border:1px solid rgba(255,255,255,0.15);
}

/* ç½‘æ ¼å±æ€§ */
.grid {
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:18px;
  margin-top:20px;
}

.item-title {
  font-size:13px;
  color:var(--subtext);
}

.item-value {
  font-size:22px;
  font-weight:600;
  color:var(--text);
  margin-top:4px;
}

/* æœç´¢æ¡† */
.search {
  margin-top:14px;
  display:flex;
  gap:8px;
}

.search input {
  flex:1;
  padding:12px 14px;
  border-radius:14px;
  border:0;
  background:rgba(255,255,255,0.1);
  color:#fff;
  font-size:15px;
  backdrop-filter:blur(6px);
}

.search button {
  padding:10px 16px;
  border:0; border-radius:14px;
  background:rgba(255,255,255,0.14);
  color:#fff;
  font-weight:600;
  cursor:pointer;
}

/* icon */
#icon {
  font-size:64px;
  margin-top:40px;
  filter:drop-shadow(0 4px 8px rgba(0,0,0,0.4));
}

/* å°å±ä¼˜åŒ– */
@media(max-width:500px){
  .temp { font-size:72px; }
  #icon { font-size:54px; }
}
</style>
</head>

<body>

<!-- å¤©æ°”èƒŒæ™¯ï¼ˆè‡ªåŠ¨åˆ‡æ¢ï¼‰ -->
<video id="bg" autoplay muted loop playsinline></video>
<div class="overlay"></div>

<div class="container">
  <div class="city" id="city">å®šä½ä¸­â€¦</div>
  <div class="time" id="time">â€”</div>

  <div id="icon">â˜ï¸</div>
  <div class="temp" id="temp">--Â°</div>
  <div class="cond" id="cond">åŠ è½½ä¸­â€¦</div>

  <!-- æœç´¢ -->
  <div class="search">
    <input id="searchInput" placeholder="æœç´¢åŸå¸‚ï¼Œä¾‹å¦‚ï¼šSydney">
    <button id="searchBtn">æœç´¢</button>
  </div>

  <!-- ä¿¡æ¯å¡ç‰‡ -->
  <div class="card">
    <div class="grid">
      <div>
        <div class="item-title">æœ€é«˜æ¸©</div>
        <div class="item-value" id="high">â€”</div>
      </div>
      <div>
        <div class="item-title">æœ€ä½æ¸©</div>
        <div class="item-value" id="low">â€”</div>
      </div>
      <div>
        <div class="item-title">é£é€Ÿ (km/h)</div>
        <div class="item-value" id="wind">â€”</div>
      </div>
      <div>
        <div class="item-title">æ¹¿åº¦</div>
        <div class="item-value" id="humidity">â€”</div>
      </div>
    </div>
  </div>
</div>

<script>
/* ===== API Key ===== */
const API_KEY = "0871934c91a1479984b40316250912";
let lastQuery = null;

/* ===== èƒŒæ™¯è§†é¢‘é€‰æ‹©ï¼ˆå’Œå¤©æ°”å¯¹åº”ï¼‰ ===== */
const videoMap = {
  clear: "https://cdn.jsdelivr.net/gh/ChatGPT-AI-Assets/weather/clear.mp4",
  cloudy: "https://cdn.jsdelivr.net/gh/ChatGPT-AI-Assets/weather/cloudy.mp4",
  rain: "https://cdn.jsdelivr.net/gh/ChatGPT-AI-Assets/weather/rain.mp4",
  storm: "https://cdn.jsdelivr.net/gh/ChatGPT-AI-Assets/weather/storm.mp4",
  snow: "https://cdn.jsdelivr.net/gh/ChatGPT-AI-Assets/weather/snow.mp4",
  fog: "https://cdn.jsdelivr.net/gh/ChatGPT-AI-Assets/weather/fog.mp4",
  night: "https://cdn.jsdelivr.net/gh/ChatGPT-AI-Assets/weather/night.mp4"
};

/* ===== Icon è½¬æ¢ï¼ˆApple é£ï¼‰ ===== */
const iconMap = {
  clear: "â˜€ï¸",
  cloudy: "â˜ï¸",
  rain: "ğŸŒ§ï¸",
  storm: "â›ˆï¸",
  snow: "â„ï¸",
  fog: "ğŸŒ«ï¸",
  night: "ğŸŒ™"
};

/* ===== é€šè¿‡æ–‡æœ¬æ˜ å°„å¤©æ°”æ¨¡å¼ ===== */
function mapConditionToMode(c, isNight){
  c = c.toLowerCase();
  if (isNight) return "night";
  if (c.includes("rain") || c.includes("shower") || c.includes("drizzle")) return "rain";
  if (c.includes("thunder") || c.includes("storm") || c.includes("é›·")) return "storm";
  if (c.includes("snow") || c.includes("sleet")) return "snow";
  if (c.includes("fog") || c.includes("mist") || c.includes("haze")) return "fog";
  if (c.includes("cloud")) return "cloudy";
  return "clear";
}

/* ===== æ›´æ–° UI ===== */
function updateUI(data){
  const loc = data.location;
  const cur = data.current;
  const forecast = data.forecast.forecastday[0].day;

  document.getElementById("city").innerText = `${loc.name}, ${loc.region || loc.country}`;
  document.getElementById("time").innerText = loc.localtime;

  document.getElementById("temp").innerText = `${cur.temp_c}Â°`;
  document.getElementById("cond").innerText = cur.condition.text;

  document.getElementById("high").innerText = `${forecast.maxtemp_c}Â°`;
  document.getElementById("low").innerText = `${forecast.mintemp_c}Â°`;
  document.getElementById("wind").innerText = `${cur.wind_kph}`;
  document.getElementById("humidity").innerText = `${cur.humidity}%`;

  // å¤©æ°”èƒŒæ™¯ä¸ icon
  const mode = mapConditionToMode(cur.condition.text, cur.is_day === 0);
  document.getElementById("icon").innerText = iconMap[mode] || "â˜ï¸";

  const bg = document.getElementById("bg");
  bg.style.opacity = 0;
  setTimeout(()=>{
    bg.src = videoMap[mode] || videoMap.clear;
    bg.style.opacity = 1;
  }, 400);
}

/* ===== è¯·æ±‚ WeatherAPI ===== */
async function loadWeather(q){
  lastQuery = q;
  const url = `https://api.weatherapi.com/v1/forecast.json?key=${API_KEY}&q=${encodeURIComponent(q)}&days=1&aqi=no&alerts=no`;
  const res = await fetch(url);
  const data = await res.json();
  updateUI(data);
}

/* ===== GPS å®šä½ ===== */
function locate(){
  navigator.geolocation.getCurrentPosition(
    pos=>{
      const q = `${pos.coords.latitude},${pos.coords.longitude}`;
      loadWeather(q);
    },
    err=>{
      loadWeather("Sydney"); // å¤‡ç”¨
    }
  );
}

/* ===== æœç´¢åŠ¨ä½œ ===== */
document.getElementById("searchBtn").onclick = ()=>{
  const v = document.getElementById("searchInput").value.trim();
  if (v) loadWeather(v);
};

document.getElementById("searchInput").onkeydown = e=>{
  if (e.key === "Enter") document.getElementById("searchBtn").click();
};

/* ===== åˆå§‹åŒ– ===== */
locate();
</script>

</body>
</html>
