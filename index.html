<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>实时天气首页</title>

    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            background-size: cover;
            background-position: center;
            font-family: "Arial", sans-serif;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            text-shadow: 0 2px 10px rgba(0,0,0,0.7);
            transition: background-image 1s ease-in-out;
        }

        .card {
            background: rgba(0,0,0,0.45);
            padding: 30px 40px;
            border-radius: 20px;
            backdrop-filter: blur(6px);
            text-align: center;
            width: 90%;
            max-width: 380px;
        }

        h1, h2, h3, p {
            margin: 6px 0;
        }

        #icon {
            width: 90px;
        }

        input {
            width: 80%;
            padding: 10px;
            border-radius: 10px;
            border: none;
            margin-top: 10px;
            font-size: 16px;
            outline: none;
        }

        button {
            margin-top: 10px;
            padding: 10px 15px;
            border-radius: 10px;
            border: none;
            background: #ffffff88;
            color: black;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="card">
    <h1 id="city">加载中...</h1>
    <img id="icon" src="">
    <h2 id="temp"></h2>
    <h3 id="condition"></h3>

    <p id="range"></p>
    <p id="wind"></p>
    <p id="humidity"></p>
    <p id="uv"></p>

    <input id="search" placeholder="输入城市，例如 Sydney">
    <button onclick="searchCity()">搜索</button>
</div>

<script>
    const API_KEY = "0871934c91a1479984b40316250912";

    // 背景图根据天气变化
    function setBackground(condition) {
        let bg;

        if (/rain|雨/i.test(condition))
            bg = "url('https://images.unsplash.com/photo-1504384308090-c894fdcc538d')";
        else if (/cloud|云/i.test(condition))
            bg = "url('https://images.unsplash.com/photo-1499346030926-9a72daac6c63')";
        else if (/sun|晴/i.test(condition))
            bg = "url('https://images.unsplash.com/photo-1501973801540-537f08ccae7b')";
        else if (/snow|雪/i.test(condition))
            bg = "url('https://images.unsplash.com/photo-1608889175123-f04eec4cde18')";
        else
            bg = "url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee')";

        document.body.style.backgroundImage = bg;
    }

    async function loadWeatherByCity(city) {
        const url = `https://api.weatherapi.com/v1/current.json?key=${API_KEY}&q=${city}&aqi=no`;

        try {
            const res = await fetch(url);
            const data = await res.json();

            updateUI(data);
        } catch {
            alert("找不到该城市，请重新输入");
        }
    }

    function updateUI(data) {
        const c = data.current;

        document.getElementById("city").innerText = data.location.name;
        document.getElementById("temp").innerText = `${c.temp_c}°C`;
        document.getElementById("condition").innerText = c.condition.text;
        document.getElementById("icon").src = "https:" + c.condition.icon;

        document.getElementById("range").innerText =
            `最高 ${c.temp_c + 2}°C / 最低 ${c.temp_c - 2}°C（模拟演示）`;

        document.getElementById("wind").innerText = `风速：${c.wind_kph} km/h`;
        document.getElementById("humidity").innerText = `湿度：${c.humidity}%`;
        document.getElementById("uv").innerText = `紫外线：${c.uv}`;

        setBackground(c.condition.text);
    }

    // 搜索框城市查询
    function searchCity() {
        const city = document.getElementById("search").value;
        if (city.trim().length === 0) return;
        loadWeatherByCity(city);
    }

    // 自动定位获取天气
    function autoLocate() {
        if (!navigator.geolocation) {
            loadWeatherByCity("Sydney");
            return;
        }

        navigator.geolocation.getCurrentPosition(
            pos => {
                const lat = pos.coords.latitude;
                const lon = pos.coords.longitude;
                loadWeatherByCity(`${lat},${lon}`);
            },
            err => {
                loadWeatherByCity("Sydney"); // 拒绝定位时默认悉尼
            }
        );
    }

    autoLocate();
</script>

</body>
</html>



  </body>
/*</html>*/
